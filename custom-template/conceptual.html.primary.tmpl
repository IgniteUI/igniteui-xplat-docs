{{!Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.}}
{{!master(layout/_master.tmpl)}}
{{{rawTitle}}}
{{{conceptual}}}
<script>
(function(){
  function applyNewTabAttributes() {
    var newTabLinks = document.querySelectorAll('a.new-tab, a[data-new-tab="true"]');

    for (var i = 0; i < newTabLinks.length; i++) {
      var link = newTabLinks[i];
      if (!link.hasAttribute('data-new-tab-processed')) {
        var href = link.getAttribute('href');

        if (href && (
          /^https?:\/\//i.test(href) ||
          /^\//.test(href) ||
          /^\.\.?\//.test(href)
        )) {
          link.setAttribute('target', '_blank');
          link.setAttribute('rel', 'noopener noreferrer');
          link.setAttribute('data-new-tab-processed', 'true');
        }
      }
    }
  }

  document.addEventListener('click', function(e) {
    var target = e.target;
    var link = null;

    while (target && target !== document) {
      if (target.tagName === 'A' &&
          (target.classList.contains('new-tab') || target.getAttribute('data-new-tab') === 'true')) {
        link = target;
        break;
      }
      target = target.parentNode;
    }

    if (link && link.href) {
      e.preventDefault();
      e.stopPropagation();
      e.stopImmediatePropagation();

      var newWindow = window.open(link.href, '_blank', 'noopener,noreferrer');
      if (newWindow) {
        newWindow.opener = null;
      }
      return false;
    }
  }, true);

  applyNewTabAttributes();

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', applyNewTabAttributes);
  }

  if (window.MutationObserver) {
    var observer = new MutationObserver(function(mutations) {
      var shouldReprocess = false;
      mutations.forEach(function(mutation) {
        if (mutation.addedNodes.length > 0) {
          shouldReprocess = true;
        }
      });
      if (shouldReprocess) {
        applyNewTabAttributes();
      }
    });

    var startObserver = function() {
      if (document.body) {
        observer.observe(document.body, {
          childList: true,
          subtree: true
        });
      } else {
        setTimeout(startObserver, 100);
      }
    };
    startObserver();
  }
})();
</script>
